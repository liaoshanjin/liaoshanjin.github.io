<!DOCTYPE html>
<html lang="zh_CN">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name="author" content="Stringer">
    <meta name="description" content="stringer 的个人博客">
    <meta name="keywords" content="php,go,程序员">

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content=" 备份管理后台数据"/>
<meta name="twitter:description" content="我们在管理后台配置的菜单、权限都是保存在数据库里的，没有办法像代码文件一样提交到 Git 版本库中，因此我们需要把开发环境中配置好的后台信息导出成 SQL 文件，然后把 SQL 文件提交到 Git 版本库中。
 执行导出 因为这是一个一次性的工作，没有必要专门写代码来处理导入和导出，所以我们选择直接用 mysqldump 这个命令行程序来导出数据库中的数据，从成本上来说比较合适：
mysqldump -t laravel-shop admin_menu admin_permissions admin_role_menu admin_role_permissions admin_role_users admin_roles admin_user_permissions admin_users &gt; database/admin.sql 命令解析：
 -t 选项代表不导出数据表结构，这些表的结构我们会通过 Laravel 的 migration 迁移文件来创建； laravel-shop 代表我们要导出的数据库名称，后面则是要导出的表列表； &gt; database/admin.sql 把导出的内容保存到 database/admin.sql 文件中。   在 Homestead 环境中我们执行 Mysql 相关的命令都不需要账号密码，因为 Homestead 都已经帮我们配置好了。在线上执行 Mysql 命令时则需要在命令行里通过 -u 和 -p 参数指明账号密码，如： mysqldump -uroot -p123456 laravel-shop &gt; database/admin.sql
 ​
使用 bash 备份 新建一个 bash 文件 back_database."/>

    <meta property="og:title" content=" 备份管理后台数据" />
<meta property="og:description" content="我们在管理后台配置的菜单、权限都是保存在数据库里的，没有办法像代码文件一样提交到 Git 版本库中，因此我们需要把开发环境中配置好的后台信息导出成 SQL 文件，然后把 SQL 文件提交到 Git 版本库中。
 执行导出 因为这是一个一次性的工作，没有必要专门写代码来处理导入和导出，所以我们选择直接用 mysqldump 这个命令行程序来导出数据库中的数据，从成本上来说比较合适：
mysqldump -t laravel-shop admin_menu admin_permissions admin_role_menu admin_role_permissions admin_role_users admin_roles admin_user_permissions admin_users &gt; database/admin.sql 命令解析：
 -t 选项代表不导出数据表结构，这些表的结构我们会通过 Laravel 的 migration 迁移文件来创建； laravel-shop 代表我们要导出的数据库名称，后面则是要导出的表列表； &gt; database/admin.sql 把导出的内容保存到 database/admin.sql 文件中。   在 Homestead 环境中我们执行 Mysql 相关的命令都不需要账号密码，因为 Homestead 都已经帮我们配置好了。在线上执行 Mysql 命令时则需要在命令行里通过 -u 和 -p 参数指明账号密码，如： mysqldump -uroot -p123456 laravel-shop &gt; database/admin.sql
 ​
使用 bash 备份 新建一个 bash 文件 back_database." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://liaoshanjin.github.io/laravel/backup-sql/" />
<meta property="article:published_time" content="2019-10-24T17:25:23+08:00" />
<meta property="article:modified_time" content="2019-10-24T17:25:23+08:00" />


    
      <base href="https://liaoshanjin.github.io/laravel/backup-sql/">
    
    <title>
   备份管理后台数据 · Stringer 的博客
</title>

    
      <link rel="canonical" href="https://liaoshanjin.github.io/laravel/backup-sql/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    
      
      
      <link rel="stylesheet" href="https://liaoshanjin.github.io/css/coder.min.28d751104f30c16da1aa1bb04015cbe662cacfe0d1b01af4f2240ad58580069c.css" integrity="sha256-KNdREE8wwW2hqhuwQBXL5mLKz&#43;DRsBr08iQK1YWABpw=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="https://liaoshanjin.github.io/css/custom.css" />
    

    
    
    <link rel="icon" type="image/png" href="https://liaoshanjin.github.io/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="https://liaoshanjin.github.io/img/favicon-16x16.png" sizes="16x16">

    <meta name="generator" content="Hugo 0.59.0" />
  </head>

  <body class=" ">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="https://liaoshanjin.github.io/">
      Stringer 的博客
    </a>
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://liaoshanjin.github.io/laravel/">Laravel</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://liaoshanjin.github.io/go/">GO</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://liaoshanjin.github.io/mysql/">MySQL</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://liaoshanjin.github.io/others/">其他</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://liaoshanjin.github.io/about/">关于</a>
          </li>
        
      
      
    </ul>
  </section>
</nav>


      <div class="content">
        
  <section class="container page">
  <article>
    <header>
      <h1> 备份管理后台数据</h1>
    </header>

    

<blockquote>
<p>我们在管理后台配置的菜单、权限都是保存在数据库里的，没有办法像代码文件一样提交到 Git 版本库中，因此我们需要把开发环境中配置好的后台信息导出成 SQL 文件，然后把 SQL 文件提交到 Git 版本库中。</p>
</blockquote>

<h2 id="执行导出">执行导出</h2>

<p>因为这是一个一次性的工作，没有必要专门写代码来处理导入和导出，所以我们选择直接用 <code>mysqldump</code> 这个命令行程序来导出数据库中的数据，从成本上来说比较合适：</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">mysqldump -t laravel-shop admin_menu admin_permissions admin_role_menu admin_role_permissions admin_role_users admin_roles admin_user_permissions admin_users &gt; database/admin.sql</pre></div>
<p>命令解析：</p>

<ul>
<li><code>-t</code> 选项代表不导出数据表结构，这些表的结构我们会通过 Laravel 的 migration 迁移文件来创建；</li>
<li><code>laravel-shop</code> 代表我们要导出的数据库名称，后面则是要导出的表列表；</li>
<li><code>&gt; database/admin.sql</code> 把导出的内容保存到 <code>database/admin.sql</code> 文件中。</li>
</ul>

<blockquote>
<p>在 Homestead 环境中我们执行 Mysql 相关的命令都不需要账号密码，因为 Homestead 都已经帮我们配置好了。在线上执行 Mysql 命令时则需要在命令行里通过 -u 和 -p 参数指明账号密码，如： <code>mysqldump -uroot -p123456 laravel-shop &gt; database/admin.sql</code></p>
</blockquote>

<p>​</p>

<h2 id="使用-bash-备份">使用 bash 备份</h2>

<p>新建一个 bash 文件 <em>back_database.sh</em></p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><span style="">#!/bin/bash
</span><span style=""></span>
<span style="font-style:italic"># 导入 .env  环境变量</span>
source ./.env
<span style="font-style:italic"># 要备份的表</span>

tables=<span style="font-style:italic">&#34;oauth_access_tokens oauth_auth_codes oauth_clients oauth_personal_access_clients oauth_refresh_tokens&#34;</span>
<span style="font-style:italic"># 执行备份</span>
mysqldump --host=<span style="font-style:italic">&#34;</span><span style="font-weight:bold;font-style:italic">${</span>DB_HOST<span style="font-weight:bold;font-style:italic">}</span><span style="font-style:italic">&#34;</span> --port=<span style="font-weight:bold;font-style:italic">${</span>DB_PORT<span style="font-weight:bold;font-style:italic">}</span> --user=<span style="font-style:italic">&#34;</span><span style="font-weight:bold;font-style:italic">${</span>DB_USERNAME<span style="font-weight:bold;font-style:italic">}</span><span style="font-style:italic">&#34;</span> --password=<span style="font-style:italic">&#34;</span><span style="font-weight:bold;font-style:italic">${</span>DB_PASSWORD<span style="font-weight:bold;font-style:italic">}</span><span style="font-style:italic">&#34;</span> -t <span style="font-weight:bold;font-style:italic">${</span>DB_DATABASE<span style="font-weight:bold;font-style:italic">}</span> <span style="font-weight:bold;font-style:italic">${</span>tables<span style="font-weight:bold;font-style:italic">}</span> &gt; database/database.sql</pre></div>
<p>为文件添加执行权限</p>
<div class="highlight"><pre style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4">chmod +x back_database.sh</pre></div>
  </article>
</section>


      </div>

      <footer class="footer">
  <section class="container">
    
      <p>Enter a text here.</p>
    
     © 2019
    
       · 
       <a href="https://gohugo.io/">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/">Coder</a>.
    
    
  </section>
</footer>

    </main>

    

  </body>

</html>
